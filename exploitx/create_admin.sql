-- Create Admin User for ExploitX
-- Run this script in MySQL to create the admin user

-- Make sure we're using the right database
USE exploitx;

-- Create the user table if it doesn't exist
CREATE TABLE IF NOT EXISTS user (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(80) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    is_admin BOOLEAN DEFAULT FALSE,
    is_super_admin BOOLEAN DEFAULT FALSE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_login DATETIME NULL,
    INDEX idx_username (username),
    INDEX idx_is_admin (is_admin),
    INDEX idx_is_super_admin (is_super_admin)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Delete existing admin user if exists
DELETE FROM user WHERE username = 'admin';

-- Insert new admin user with password 'admin123'
-- The password hash below is for 'admin123' using Werkzeug's generate_password_hash
INSERT INTO user (username, password_hash, is_admin, is_super_admin, created_at) 
VALUES (
    'admin',
    'pbkdf2:sha256:600000$YOUR_SALT_HERE$YOUR_HASH_HERE',
    TRUE,
    TRUE,
    NOW()
);

-- Show the created user
SELECT id, username, is_admin, is_super_admin, created_at FROM user WHERE username = 'admin';

-- Instructions for manual password setting:
-- 1. Start your Flask app: python3 app.py
-- 2. Go to: http://localhost:5000/admin/reset_admin_passwords
-- 3. This will reset the admin password to: YourNewPassword123!
-- 4. Login with: admin / YourNewPassword123! 