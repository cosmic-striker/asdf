#!/usr/bin/env python3
"""
Setup Admin User for ExploitX
This script provides step-by-step instructions to set up the admin user.
"""

import os
import sys

def print_instructions():
    print("ğŸ”§ ExploitX Admin Setup Instructions")
    print("=" * 50)
    print()
    print("ğŸ“‹ Step 1: Start MySQL Server")
    print("   Run one of these commands:")
    print("   - sudo systemctl start mysql")
    print("   - sudo service mysql start")
    print("   - sudo /etc/init.d/mysql start")
    print()
    print("ğŸ“‹ Step 2: Create Database")
    print("   Run: mysql -u root -p")
    print("   Then in MySQL console:")
    print("   CREATE DATABASE IF NOT EXISTS exploitx;")
    print("   EXIT;")
    print()
    print("ğŸ“‹ Step 3: Run Database Initialization")
    print("   python3 init_db.py")
    print()
    print("ğŸ“‹ Step 4: Create Admin User")
    print("   python3 fix_login.py")
    print()
    print("ğŸ“‹ Step 5: Start Flask App")
    print("   python3 app.py")
    print()
    print("ğŸ“‹ Step 6: Login")
    print("   Go to: http://localhost:5000/admin/login")
    print("   Username: admin")
    print("   Password: admin123")
    print()
    print("ğŸ”§ Alternative: Quick Setup")
    print("   If you have Docker, you can use:")
    print("   docker-compose up -d")
    print()

def check_mysql():
    """Check if MySQL is running"""
    try:
        import pymysql
        connection = pymysql.connect(
            host='localhost',
            user='root',
            password='root',
            charset='utf8mb4'
        )
        connection.close()
        return True
    except Exception as e:
        return False

def main():
    print_instructions()
    
    print("ğŸ” Checking MySQL connection...")
    if check_mysql():
        print("âœ… MySQL is running and accessible!")
        print()
        print("ğŸš€ You can now run:")
        print("   python3 fix_login.py")
    else:
        print("âŒ MySQL is not accessible")
        print("   Please start MySQL first using the instructions above")
        print()
        print("ğŸ’¡ Common MySQL start commands:")
        print("   Ubuntu/Debian: sudo systemctl start mysql")
        print("   CentOS/RHEL: sudo systemctl start mysqld")
        print("   macOS: brew services start mysql")
        print("   Windows: net start mysql")

if __name__ == "__main__":
    main() 